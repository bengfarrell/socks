<html>
<head>
    <meta charset="UTF-8">
    <title>Cloning Demo</title>
</head>
<body>
<h1>Cloning Demo</h1>
 <p>Use the arrow keys to create a clone and move the default blender cube. Hold down shift to move in the Z direction</p>

<socks-connector showactivity></socks-connector>
<script type="module" src="../src/components/connector/index.js"></script>
<script type="module">
    import { SocketEvent } from '../src/components/connector/connectionevent.js';
    import { BlenderCommand, CURRENT_SELECTION } from '../src/blender-command';

    let conn;
    document.body.addEventListener(SocketEvent.OPEN, (event) => {
        conn = event.connection;
    });

    let counter = 0;
    const move = 3;
    const delta = [0 , 0,  0];
    document.addEventListener('keydown', (event) => {
        switch (event.key) {
            case "ArrowLeft":
                if (event.shiftKey) {
                    delta[2] -= move;
                } else {
                    delta[0] -= move;
                }
                counter ++;
                break;
            case "ArrowRight":
                if (event.shiftKey) {
                    delta[2] += move;
                } else {
                    delta[0] += move;
                }
                counter ++;
                break;
            case "ArrowUp":
                if (event.shiftKey) {
                    delta[2] -= move;
                } else {
                    delta[1] -= move;
                }
                counter ++;
                break;
            case "ArrowDown":
                if (event.shiftKey) {
                    delta[2] += move;
                } else {
                    delta[1] += move;
                }
                counter ++;
                break;
        }

        conn.send(BlenderCommand.update(
            {
                target: `cubey-${counter}`,
                template: CURRENT_SELECTION,
                transforms: [
                        {
                            transform: 'translate',
                            x: delta[0], y: delta[1], z: delta[2],
                        }
                    ]
            }));
    });
</script>
</body>
</html>
